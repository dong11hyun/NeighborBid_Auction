# NeighborBid: ì‹¤ì‹œê°„ ë™ì‹œì„± ì œì–´ ê²½ë§¤ í”Œë«í¼

> **ë°ì´í„° ë¬´ê²°ì„±ì„ ë³´ì¥í•˜ëŠ” ê³ ì„±ëŠ¥ ì‹¤ì‹œê°„ ì…ì°° ì‹œìŠ¤í…œ**
> ê²½ë§¤ ë§ˆê° ì§ì „ ë™ì‹œ ì…ì°° í™˜ê²½ì—ì„œ Race Conditionì„ ë°©ì§€í•˜ê³ , ê¸ˆìœµ ë°ì´í„° ì •í•©ì„±ì„ 100% ë³´ì¥í•˜ëŠ” í”Œë«í¼

**í”„ë¡œì íŠ¸ ê¸°ê°„**: 2026.01 ~ (ì§„í–‰ì¤‘)

**ì°¸ì—¬ ì¸ì›**: 2ì¸ (ê¹€ë™í˜„, ì „ëŒ€ì›)

**ë°°í¬ ìƒíƒœ**: HTTP (IP ì ‘ì†), ë„ë©”ì¸ ë¯¸ì ìš©

---

## ğŸ“ ëª©ì°¨

1. [ğŸ¤” í”„ë¡œì íŠ¸ ê°œìš”](#-í”„ë¡œì íŠ¸-ê°œìš”)
   - [ë¬¸ì œ ì¸ì‹](#ë¬¸ì œ-ì¸ì‹)
   - [í•´ê²° ë°©ì•ˆ](#í•´ê²°-ë°©ì•ˆ)
   - [ì„±ê³¼](#ì„±ê³¼)
2. [ğŸ§ ë¬¸ì œ í•´ê²° ê³¼ì •](#-ë¬¸ì œ-í•´ê²°-ê³¼ì •)
   - [Q1. ë™ì‹œì„± ì´ìŠˆ â€” Race Condition](#q1-ë™ì‹œì„±-ì´ìŠˆ--race-condition)
   - [Q2. ì„±ëŠ¥ ë³‘ëª© â€” N+1 Problem](#q2-ì„±ëŠ¥-ë³‘ëª©--n1-problem)
   - [Q3. ê°€ì§œ ì•Œë¦¼ ë¬¸ì œ â€” íŠ¸ëœì­ì…˜ ë¡¤ë°±](#q3-ê°€ì§œ-ì•Œë¦¼-ë¬¸ì œ--íŠ¸ëœì­ì…˜-ë¡¤ë°±)
   - [Q4. ê¸ˆìœµ ë°ì´í„° ì„¤ê³„ â€” ì—ìŠ¤í¬ë¡œ íŒ¨í„´](#q4-ê¸ˆìœµ-ë°ì´í„°-ì„¤ê³„--ì—ìŠ¤í¬ë¡œ-íŒ¨í„´)
   - [Q5. í•˜ì´ë¸Œë¦¬ë“œ ì•„í‚¤í…ì²˜ ì„¤ê³„](#q5-í•˜ì´ë¸Œë¦¬ë“œ-ì•„í‚¤í…ì²˜-ì„¤ê³„)
3. [ğŸ“‹ ì¶”ê°€ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ìš”ì•½](#-ì¶”ê°€-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…-ìš”ì•½)
4. [ğŸ«¡ ì‹¤í–‰ ê°€ì´ë“œ](#-ì‹¤í–‰-ê°€ì´ë“œ)
5. [ğŸ¤“ ì„±ëŠ¥ ì§€í‘œ](#-ì„±ëŠ¥-ì§€í‘œ)
6. [ğŸ¥¸ ë²„ì „ë³„ ê°œë°œ íˆìŠ¤í† ë¦¬](#-ë²„ì „ë³„-ê°œë°œ-íˆìŠ¤í† ë¦¬)
7. [ğŸ«  ê¸°ìˆ  ìŠ¤íƒ & ì•„í‚¤í…ì²˜](#-ê¸°ìˆ -ìŠ¤íƒ--ì•„í‚¤í…ì²˜)

---

## ğŸ¤” í”„ë¡œì íŠ¸ ê°œìš”

### ë¬¸ì œ ì¸ì‹

#### ëˆì´ ì¦ë°œí•  ìˆ˜ ìˆë‹¤?
ê²½ë§¤ ì‹œìŠ¤í…œ íŠ¹ì„±ìƒ ì¢…ë£Œ ì§ì „ **ë™ì‹œ ì…ì°°(Concurrent Bids)**ì´ í­ì£¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê¸°ì¡´ ì‹œìŠ¤í…œì€ Aì™€ Bê°€ í†µì¥ ì”ê³  100ë§Œì›ì„ ê°€ì§€ê³  ë™ì‹œì— 100ë§Œì› ì…ì°°ì„ ì‹œë„í•˜ë©´, íƒ€ì´ë°ì— ë”°ë¼ ë‘˜ ë‹¤ ì…ì°°ì— ì„±ê³µí•˜ê³  ì”ê³ ëŠ” í•œ ë²ˆë§Œ ì°¨ê°ë˜ëŠ” **Critical Race Condition**ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

```
[ì¬í˜„ ì‹œë‚˜ë¦¬ì˜¤]
1. ì”ì•¡ 10,000ì›ì¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
2. ë¸Œë¼ìš°ì € íƒ­ 2ê°œ ì—´ê¸° (ê²½ë§¤ A, ê²½ë§¤ B)
3. ê±°ì˜ ë™ì‹œì— ë‘ íƒ­ì—ì„œ 10,000ì› ì…ì°°
4. ê²°ê³¼: ë‘˜ ë‹¤ ì„±ê³µ. ì”ì•¡ = -10,000ì› âŒ
```

#### ì„œë²„ê°€ ë„ˆë¬´ ëŠë¦¬ë‹¤
ê²½ë§¤ ëª©ë¡ ì¡°íšŒ ì‹œ íŒë§¤ì ì •ë³´, ì¹´í…Œê³ ë¦¬, ì…ì°° ë‚´ì—­ì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ **N+1 ì¿¼ë¦¬**ê°€ ë°œìƒí•˜ì—¬, 100ê°œì˜ ê²½ë§¤ ê¸€ ë¡œë”©ì— 300ë²ˆ ì´ìƒì˜ DB ì¡°íšŒê°€ ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤.

### í•´ê²° ë°©ì•ˆ

- **ë°ì´í„° ë¬´ê²°ì„± í™•ë³´**: **PostgreSQL**ì˜ **Row-Level Locking (`select_for_update`)**ì„ ë„ì…í•˜ì—¬ ì…ì°° íŠ¸ëœì­ì…˜ì„ ì›ìì (Atomic)ìœ¼ë¡œ ì²˜ë¦¬.
- **ì„±ëŠ¥ ìµœì í™”**: Django ORMì˜ **`select_related` / `prefetch_related`**ë¥¼ ì² ì €íˆ ì ìš©í•˜ì—¬ ì¿¼ë¦¬ ìˆ˜ë¥¼ 98% ê°ì†Œ.
- **ì‹¤ì‹œê°„ì„±**: **Redis**ì™€ **Django Channels**ë¥¼ í™œìš©í•œ WebSocket í†µì‹ ìœ¼ë¡œ ì…ì°° í˜„í™©ì„ 0.1ì´ˆ ë‚´ ì „íŒŒ.

### ì„±ê³¼

| í•­ëª© | ìˆ˜ì¹˜ | ë¹„ê³  |
|------|------|------|
| **ë™ì‹œ ì…ì°° ë°ì´í„° ì˜¤ì°¨** | **0%** | 100ëª… ë™ì‹œ ì…ì°° í…ŒìŠ¤íŠ¸ (JMeter) |
| **API ì‘ë‹µ ì†ë„** | í‰ê·  80ms | ì¿¼ë¦¬ ìµœì í™” ì „ 1200ms ëŒ€ë¹„ 15ë°° í–¥ìƒ |
| **ëª©ë¡ ì¡°íšŒ ì¿¼ë¦¬ ìˆ˜** | **4íšŒ** | ìµœì í™” ì „ 300+íšŒ ëŒ€ë¹„ 98% ê°ì†Œ |

---

## ğŸ§ ë¬¸ì œ í•´ê²° ê³¼ì •

### Q1. ë™ì‹œì„± ì´ìŠˆ â€” Race Condition

#### ìƒí™©

SQLite ê¸°ë°˜ì˜ ê°œë°œ í™˜ê²½ì—ì„œëŠ” íŒŒì¼ ì „ì²´ì— ë½(File Lock)ì´ ê±¸ë ¤ ë™ì‹œì„± ë¬¸ì œë¥¼ ì²´ê°í•˜ê¸° ì–´ë ¤ì› ìœ¼ë‚˜, í”„ë¡œë•ì…˜ í™˜ê²½ì„ ê°€ì •í•œ í…ŒìŠ¤íŠ¸ì—ì„œ ì¹˜ëª…ì ì¸ ê²°í•¨ ë°œê²¬.

```python
# ê¸°ì¡´ ì½”ë“œ (ë¬¸ì œ ë°œìƒ)
wallet = Wallet.objects.get(user=user)
wallet.balance -= amount
wallet.save()
# Aì™€ Bê°€ ë™ì‹œì— ì´ ë¼ì¸ì„ ì‹¤í–‰í•˜ë©´, ë‘˜ ë‹¤ ê°™ì€ ì”ì•¡ì„ ì½ì–´ì„œ ë®ì–´ì”Œì›€
```

#### ì›ì¸ ë¶„ì„: ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ê²€ì¦ì˜ í•œê³„

| ì‹œê°„ | ìš”ì²­ A | ìš”ì²­ B | DB ìƒíƒœ (balance) |
| :--- | :--- | :--- | :--- |
| **T=0** | ì”ì•¡ ì¡°íšŒ â†’ 10,000ì› | ì”ì•¡ ì¡°íšŒ â†’ 10,000ì› | `10,000` |
| **T=1** | ê²€ì¦ í†µê³¼ | ê²€ì¦ í†µê³¼ | `10,000` |
| **T=2** | ì°¨ê° ì‹¤í–‰ (`balance = 0`) | ì°¨ê° ì‹¤í–‰ (`balance = -10,000`) | âŒ `-10,000` |

**ë¬¸ì œì˜ ë³¸ì§ˆ:** ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì˜ `if balance >= amount` ê²€ì‚¬ê°€ **ì›ìì (Atomic)**ì´ì§€ ì•ŠìŒ.

#### í•´ê²° ê³¼ì •: 3ê°€ì§€ ì‹œë„

**ì‹œë„ 1: Python threading.Lock âŒ**
```python
import threading
lock = threading.Lock()

def place_bid(...):
    with lock:  # ë¬¸ì œ: ë©€í‹° í”„ë¡œì„¸ìŠ¤ì—ì„œëŠ” ëª»ì”€
        ...
```
**ì‹¤íŒ¨ ì´ìœ :** Gunicorn/DaphneëŠ” ë©€í‹° í”„ë¡œì„¸ìŠ¤ í™˜ê²½. ê° í”„ë¡œì„¸ìŠ¤ëŠ” ë³„ë„ ë©”ëª¨ë¦¬ ê³µê°„ì„ ì‚¬ìš©í•˜ë¯€ë¡œ Lockì´ ê³µìœ ë˜ì§€ ì•ŠìŒ.

**ì‹œë„ 2: ë‚™ê´€ì  ë½ (Optimistic Lock) âš ï¸**
```python
updated = Wallet.objects.filter(
    user=user, version=old_version
).update(balance=F('balance') - amount, version=F('version') + 1)

if updated == 0:
    raise ConflictError("ì¬ì‹œë„ í•„ìš”")
```
**í•œê³„:** ë§ˆê° ì§ì „ì—ëŠ” ì¬ì‹œë„ ì¤‘ ê²½ë§¤ê°€ ì¢…ë£Œë  ìˆ˜ ìˆìŒ. ì¶©ëŒì´ ë¹ˆë²ˆí•œ ê²½ë§¤ì—ì„œëŠ” ì„±ëŠ¥ ì €í•˜.

**ì‹œë„ 3: ë¹„ê´€ì  ë½ (Pessimistic Lock) âœ… ìµœì¢… ì±„íƒ**
```python
# ê°œì„  ì½”ë“œ
from django.db import transaction

def place_bid(auction_id, user, amount):
    with transaction.atomic():
        # DB ë ˆë²¨ì—ì„œ Row Lock - ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì€ ëŒ€ê¸°
        wallet = Wallet.objects.select_for_update().get(user=user)
        auction = Auction.objects.select_for_update().get(id=auction_id)
        
        if wallet.balance < amount:
            raise ValueError("ì”ì•¡ ë¶€ì¡±")
        
        wallet.balance -= amount
        wallet.locked_balance += amount
        wallet.save()
```

#### ğŸ¤“ ê²°ë¡ : ì „ëµ ë¹„êµ

| ê¸°ì¤€ | ë‚™ê´€ì  ë½ | ë¹„ê´€ì  ë½ |
|---|:---:|:---:|
| ë§ˆê° ì§ì „ íŠ¸ë˜í”½ | ì¬ì‹œë„ í­ë°œ | âœ… ìˆœì°¨ ì²˜ë¦¬ |
| ê¸ˆìœµ ë°ì´í„° ì •í™•ì„± | ì¬ì‹œë„ ì¤‘ ì˜¤ë¥˜ ê°€ëŠ¥ | âœ… ë¬´ì¡°ê±´ ë³´ì¥ |
| êµ¬í˜„ ë³µì¡ë„ | ì¬ì‹œë„ ë¡œì§ í•„ìš” | âœ… ë‹¨ìˆœ |

> ì´í›„ 100ê±´ì˜ ë™ì‹œ ì…ì°° ì‹œë®¬ë ˆì´ì…˜ì—ì„œ **ë°ì´í„° ì˜¤ì°¨ 0ê±´** ë‹¬ì„±.

---

### Q2. ì„±ëŠ¥ ë³‘ëª© â€” N+1 Problem

#### ìƒí™©

ê²½ë§¤ ë¦¬ìŠ¤íŠ¸ API í˜¸ì¶œ ì‹œ, ê° ê²½ë§¤ ì•„ì´í…œë§ˆë‹¤ ì—°ê²°ëœ `Seller`, `Category`, `Region` ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ê³„ì†í•´ì„œ DBë¥¼ ì¡°íšŒí•¨.

```python
# [BEFORE] 300+ Queries
auctions = Auction.objects.filter(status='ACTIVE')
# í…œí”Œë¦¿ì—ì„œ auction.seller, auction.category ì ‘ê·¼ ì‹œ ì¶”ê°€ ì¿¼ë¦¬ ë°œìƒ
```

#### í•´ê²°

```python
# [AFTER] 4 Queries
auctions = Auction.objects.filter(status='ACTIVE').select_related(
    'seller', 'category', 'region'
).prefetch_related(
    'bids', 'watchers'
).order_by('-created_at')
```

#### ê²°ê³¼

| í•­ëª© | ë³€ê²½ ì „ | ë³€ê²½ í›„ | ê°œì„ ìœ¨ |
|------|---------|---------|--------|
| ì¿¼ë¦¬ ìˆ˜ | 312íšŒ | 4íšŒ | **98.7%** |
| ì‘ë‹µ ì‹œê°„ | 1.2ì´ˆ | 0.08ì´ˆ | **15ë°°** |

> AWS Lightsail($10 í”Œëœ)ì˜ ì ì€ ë¦¬ì†ŒìŠ¤ë¡œë„ ì¾Œì í•œ ì„œë¹„ìŠ¤ ê°€ëŠ¥.

---

### Q3. ê°€ì§œ ì•Œë¦¼ ë¬¸ì œ â€” íŠ¸ëœì­ì…˜ ë¡¤ë°±

#### ìƒí™©

```
[ì¬í˜„]
1. ì‚¬ìš©ìê°€ "ì¦‰ì‹œ êµ¬ë§¤" í´ë¦­
2. "êµ¬ë§¤ ì„±ê³µ!" ì•Œë¦¼ ìˆ˜ì‹  
3. ìƒˆë¡œê³ ì¹¨ ì´í›„ ìƒí’ˆì´ ì—¬ì „íˆ "íŒë§¤ ì¤‘" 
```

#### ì›ì¸: íŠ¸ëœì­ì…˜ ë¡¤ë°± vs ì•Œë¦¼ ì „ì†¡

```python
# ë¬¸ì œ ì½”ë“œ
with transaction.atomic():
    auction.status = 'ENDED'
    auction.save()
    
    # ì•Œë¦¼ì„ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì „ì†¡
    channel_layer.group_send(...)  # ì¦‰ì‹œ ì „ì†¡ë¨
    
    validate_something()  # Exception â†’ ë¡¤ë°±
    # ì•Œë¦¼ì€ ì´ë¯¸ ì „ì†¡ë¨!
```

**ë¬¸ì œ:** WebSocket ë©”ì‹œì§€ ì „ì†¡ì€ **ë¡¤ë°±ë˜ì§€ ì•ŠëŠ” ì™¸ë¶€ ì‹œìŠ¤í…œ í˜¸ì¶œ**.

#### í•´ê²°: transaction.on_commit

```python
def buy_now(auction_id, buyer):
    def send_notification():
        channel_layer.group_send(f'auction_{auction_id}', {...})

    with transaction.atomic():
        # ... êµ¬ë§¤ ë¡œì§ ...
        auction.status = 'ENDED'
        auction.save()
        
        # ì»¤ë°‹ì´ í™•ì •ëœ í›„ì—ë§Œ ì‹¤í–‰
        transaction.on_commit(send_notification)
```

> **ì›ì¹™:** "ì‚¬ì´ë“œ ì´í™íŠ¸(ì•Œë¦¼, ì´ë©”ì¼, ì™¸ë¶€ API)ëŠ” ë°˜ë“œì‹œ DB ì»¤ë°‹ í›„ì— ì‹¤í–‰"

---

### Q4. ê¸ˆìœµ ë°ì´í„° ì„¤ê³„ â€” ì—ìŠ¤í¬ë¡œ íŒ¨í„´

#### ìƒí™©

ì‚¬ìš©ìê°€ 10,000ì›ì„ ì…ì°°í–ˆì„ ë•Œ:
- âŒ ë°”ë¡œ ì°¨ê°í•˜ë©´ â†’ "ë‚™ì°°ë„ ì•ˆëëŠ”ë° ë‚´ ëˆì´ ì‚¬ë¼ì¡ŒìŒ" (UX ë¬¸ì œ)
- âŒ ì°¨ê° ì•ˆ í•˜ë©´ â†’ ê°™ì€ ëˆìœ¼ë¡œ ì—¬ëŸ¬ ê²½ë§¤ì— ì…ì°° ê°€ëŠ¥ (ì´ì¤‘ ì§€ì¶œ)

#### í•´ê²°: ì´ì¤‘ ì¥ë¶€ (ì—ìŠ¤í¬ë¡œ íŒ¨í„´)

```python
# wallet/models.py
class Wallet(models.Model):
    balance = models.DecimalField(...)        # ê°€ìš© ì”ì•¡
    locked_balance = models.DecimalField(...) # ì…ì°° ì¤‘ ì ê¸´ ê¸ˆì•¡
```

**ìê¸ˆ íë¦„**

| êµ¬ë¶„ | ê°€ìš© ì”ì•¡ (Balance) | ì˜ˆì¹˜ê¸ˆ (Locked) | ì´ ìì‚° | ë¹„ê³  |
| :--- | :--- | :--- | :--- | :--- |
| **ì…ì°° ì‹œ** | 10,000 â†’ **0** | 0 â†’ **10,000** | 10,000 | ì”ì•¡ ì°¨ê° ë° ê¸ˆì•¡ ì ê¸ˆ |
| **ë‚™ì°° ì‹œ** | 0 | 10,000 â†’ **0** | **0** | ì ê¸ˆ í•´ì œ ë° íŒë§¤ì ì†¡ê¸ˆ |
| **ìœ ì°° ì‹œ** | 0 â†’ **10,000** | 10,000 â†’ **0** | 10,000 | ì ê¸ˆ í•´ì œ ë° ì”ì•¡ ë³µêµ¬ |

**íš¨ê³¼:**
- ì‚¬ìš©ìëŠ” "ì…ì°° ì¤‘ 10,000ì›"ì„ í™•ì¸ ê°€ëŠ¥ (íˆ¬ëª…ì„±)
- ì‹œìŠ¤í…œì€ `balance`ë§Œ ì²´í¬í•˜ë©´ ì´ì¤‘ ì§€ì¶œ ìë™ ì°¨ë‹¨

---

### Q5. í•˜ì´ë¸Œë¦¬ë“œ ì•„í‚¤í…ì²˜ ì„¤ê³„

#### ìƒí™©

> **"ëª¨ë“  ê²½ë§¤ì— WebSocketì„ ë¶™ì—¬ì•¼ í•˜ëŠ”ê°€?"**

| ê²½ë§¤ ìœ í˜• | ì˜ˆìƒ ì…ì°° ë¹ˆë„ | WebSocket ë¹„ìš© | ì‹¤ì‹œê°„ í•„ìš”ì„± |
|---|:---:|:---:|:---:|
| ë™ë„¤ ì¤‘ê³  ê°€êµ¬ | í•˜ë£¨ 20ê±´ ë‚´ì™¸ | Redis ìƒì‹œ êµ¬ë™ | âš ï¸ ë¶ˆí•„ìš” |
| í•œì •íŒ ìŠ¤ë‹ˆì»¤ì¦ˆ | ì´ˆë‹¹ 10~100ê±´ | ë‹¹ì—°íˆ í•„ìš” | âœ… í•„ìˆ˜ |

#### í•´ê²°: ë‹¨ì¼ í•„ë“œë¡œ ì•„í‚¤í…ì²˜ ë¶„ê¸°

```python
# auctions/models.py
class Auction(models.Model):
    is_national = models.BooleanField(default=False)
    # True  â†’ WebSocket + Redis Pub/Sub
    # False â†’ HTTP + DB íŠ¸ëœì­ì…˜ë§Œ
```

**ì¥ì :**
- **ì¸í”„ë¼ ë¹„ìš© ì ˆê°** (ë™ë„¤ ê²½ë§¤ëŠ” Redis ë¶ˆí•„ìš”)
- **ì ì§„ì  í™•ì¥ ê°€ëŠ¥** (ë‚˜ì¤‘ì— ë™ë„¤ ê²½ë§¤ë„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì „í™˜ ê°€ëŠ¥)
- **ì½”ë“œ ë³µì¡ë„ ìµœì†Œí™”** (ë¶„ê¸°ë¬¸ í•˜ë‚˜ë¡œ ì²˜ë¦¬)

---

## ğŸ“‹ ì¶”ê°€ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ìš”ì•½

| # | ë¬¸ì œ | ì›ì¸ | í•´ê²°ì±… |
|---|---|---|---|
| 1 | **AttributeError: 'winner'** | ì¦‰ì‹œ êµ¬ë§¤ ì‹œ ë‚™ì°°ì í•„ë“œ ë¶€ì¬ | Auction ëª¨ë¸ì— `winner` í•„ë“œ ì¶”ê°€ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ |
| 2 | **WebSocket ëŠê¹€** | ë¹„ì •ìƒ ì¢…ë£Œ ì‹œ ë¦¬ì†ŒìŠ¤ ì ìœ  | `consumers.py`ì˜ `disconnect` ë©”ì„œë“œì— ì •êµí•œ ê·¸ë£¹ í•´ì œ ë¡œì§ ì¶”ê°€ |
| 3 | **ì´ë¯¸ì§€ ë³´ì•ˆ** | ì•…ì„± íŒŒì¼(.exe) ì—…ë¡œë“œ ê°€ëŠ¥ | `FileExtensionValidator`ë¡œ í™•ì¥ì ì œí•œ (jpg, png) ì ìš© |
| 4 | **DB í¬íŠ¸ ì¶©ëŒ** | ë¡œì»¬ Postgres(5432) ì ìœ  | Docker Compose í¬íŠ¸ ë§¤í•‘ì„ `5433:5432`ë¡œ ë³€ê²½í•˜ì—¬ ê³µì¡´ |
| 5 | **SECRET_KEY ë…¸ì¶œ** | settings.py í•˜ë“œì½”ë”© | `.env` íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ê³  `os.environ.get`ìœ¼ë¡œ ë¡œë“œ |
| 6 | **ì¶©ì „ íŠ¸ëœì­ì…˜ ëˆ„ë½** | `charge_wallet()`ì— atomic ì—†ìŒ | `transaction.atomic()` + `select_for_update()` ì ìš© |
| 7 | **ì…ì°° ë‹¨ìœ„ ë¬´ì‹œ** | 1000ì› ë‹¨ìœ„ì¸ë° 1001ì› ì…ì°° ê°€ëŠ¥ | `amount % bid_unit != 0` ê²€ì¦ ë¡œì§ ì¶”ê°€ |

> ìƒì„¸ ê¸°ë¡: [zë°°í¬_ì „_í›„mdíŒŒì¼/1_1í™•ì¥ì„±.md](zë°°í¬_ì „_í›„mdíŒŒì¼/1_1í™•ì¥ì„±.md)

---

## ğŸ«¡ ì‹¤í–‰ ê°€ì´ë“œ

### í™˜ê²½ ì„¤ì •

ì´ í”„ë¡œì íŠ¸ëŠ” **Docker** í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œì»¬ ê°œë°œ í™˜ê²½ê³¼ í”„ë¡œë•ì…˜ í™˜ê²½ì„ ì™„ë²½í•˜ê²Œ ì¼ì¹˜ì‹œì¼°ìŠµë‹ˆë‹¤.

```bash
# 1. í”„ë¡œì íŠ¸ í´ë¡ 
git clone https://github.com/dong11hyun/NeighborBid_Auction.git
cd NeighborBid_Auction

# 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env ìƒì„±)
# ì•„ë˜ ë‚´ìš©ì„ .env íŒŒì¼ì— ì‘ì„±í•˜ì„¸ìš”
echo "DJANGO_SECRET_KEY=yoursecretkey" > .env
echo "DB_PASSWORD=securepass" >> .env
echo "ALLOWED_HOSTS=*" >> .env

# 3. Docker ì‹¤í–‰ (ë¹Œë“œ ë° ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰)
docker-compose up -d --build

# 4. DB ë§ˆì´ê·¸ë ˆì´ì…˜ ë° ê´€ë¦¬ì ìƒì„±
docker-compose exec web python manage.py migrate
docker-compose exec web python manage.py createsuperuser
```

### ì›¹ ì ‘ì†
- **Main**: `http://localhost:8000` (ì„œë²„ ë°°í¬ ì‹œ `http://<IP>:8000`)
- **Admin**: `http://localhost:8000/admin`

### ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ (Metabase + Sentry)
- **Metabase**: ë¹„ì¦ˆë‹ˆìŠ¤ ì§€í‘œ (ì¼ì¼ ì…ì°° ìˆ˜, ë§¤ì¶œ í˜„í™©) ì‹œê°í™” ë„êµ¬. `http://localhost:3000` (Docker ì»¨í…Œì´ë„ˆ ì¶”ê°€ ì‹œ)
- **Sentry**: ì‹¤ì‹œê°„ ì—ëŸ¬ ì¶”ì . 500 ì—ëŸ¬ ë°œìƒ ì‹œ ì´ë©”ì¼ ì•Œë¦¼ ì—°ë™.

---

## ğŸ¤“ ì„±ëŠ¥ ì§€í‘œ

| í•­ëª© | ìµœì í™” ì „ | ìµœì í™” í›„ | ê°œì„ ìœ¨ |
|------|-----------|-----------|--------|
| **ë©”ì¸ í˜ì´ì§€ ì¿¼ë¦¬ ìˆ˜** | 312íšŒ | 4íšŒ | **98.7%** |
| **API í‰ê·  ì‘ë‹µ ì‹œê°„** | 1200ms | 80ms | **15ë°°** |
| **ë™ì‹œ ì…ì°° ì„±ê³µë¥ ** | 85% (ë°ì´í„° ê¹¨ì§) | 100% (ì •í•©ì„± ë³´ì¥) | - |
| **ì„œë²„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰** | ì˜ˆì¸¡ ë¶ˆê°€ | 1.2GB (ì•ˆì •ì ) | - |

---

## ğŸ¥¸ ë²„ì „ë³„ ê°œë°œ íˆìŠ¤í† ë¦¬

### v1.0 â€” MVP (Minimum Viable Product)
- Django ê¸°ë³¸ ê¸°ëŠ¥ì„ í™œìš©í•œ ê²½ë§¤ CRUD êµ¬í˜„.
- SQLite ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©.
- **í•œê³„**: ì‹¤ì‹œê°„ì„±ì´ ì—†ì–´ ì‚¬ìš©ìê°€ ìƒˆë¡œê³ ì¹¨ì„ í•´ì•¼ ì…ì°°ê°€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŒ.

### v2.0 â€” Real-time & WebSocket
- **Redis + Django Channels** ë„ì….
- WebSocketì„ í†µí•´ ì…ì°° ë°œìƒ ì‹œ ì¦‰ì‹œ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ê°€ê²© ê°±ì‹  ì „íŒŒ.
- 1:1 ì±„íŒ… ê¸°ëŠ¥ ì¶”ê°€ (íŒë§¤ì-ë‚™ì°°ì ê°„).

### v3.0 â€” í™•ì¥ì„± ë° ì•ˆì •ì„± (í˜„ì¬ ë²„ì „)
- **PostgreSQL ë„ì…**: ë™ì‹œì„± ì œì–´ë¥¼ ìœ„í•œ DB êµì²´.
- **Dockerization**: ê°œë°œ/ìš´ì˜ í™˜ê²½ í†µì¼.
- **ë¹„ë™ê¸° í (Celery)**: ê²½ë§¤ ì¢…ë£Œ ìŠ¤ì¼€ì¤„ë§ ìë™í™”.
- **ë³´ì•ˆ ê°•í™”**: Nginx ë„ì… ë° í™˜ê²½ ë³€ìˆ˜ ë¶„ë¦¬.

---

## ğŸ«  ê¸°ìˆ  ìŠ¤íƒ & ì•„í‚¤í…ì²˜

| ë¶„ë¥˜ | ê¸°ìˆ  |
|------|------|
| **Language** | Python 3.11 |
| **Framework** | Django 5.2 (ASGI/WSGI) |
| **Real-time** | Django Channels, Daphne |
| **Database** | PostgreSQL 15, Redis (Cache/PubSub) |
| **Infra** | AWS Lightsail, Docker, Docker Compose |
| **Web Server** | Nginx |
| **Task Queue** | Celery, RabbitMQ/Redis |

### ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```text
[ì™¸ë¶€ ìš”ì²­]
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
User (Client) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚ Nginx (Web Server)â”‚
                                    â”‚ (Reverse Proxy)  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚                     â”‚                     â”‚
                       â–¼                     â–¼                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Django (WSGI)  â”‚    â”‚ Daphne (ASGI)  â”‚    â”‚  Celery Worker â”‚
              â”‚ (API/Admin)    â”‚    â”‚ (WebSocket)    â”‚    â”‚ (Async Task)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                      â”‚                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”
         â–¼                       â–¼      â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL     â”‚      â”‚     Redis      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Celery Beat    â”‚
â”‚ (Main DB)      â”‚      â”‚ (Cache/PubSub) â”‚                     â”‚ (Scheduler)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í”„ë¡œì íŠ¸ êµ¬ì¡°

```text
NeighborBid/
â”œâ”€â”€ auctions/            # í•µì‹¬ ê²½ë§¤ ë¡œì§ (Models, Services, Consumers)
â”‚   â”œâ”€â”€ models.py        # Auction, Bid ëª¨ë¸
â”‚   â”œâ”€â”€ services.py      # place_bid, determine_winner ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ consumers.py     # WebSocket Consumer
â”‚   â””â”€â”€ views.py         # HTTP View
â”œâ”€â”€ wallet/              # ì§€ê°‘ ë° ê±°ë˜ ê´€ë¦¬
â”‚   â”œâ”€â”€ models.py        # Wallet, Transaction ëª¨ë¸
â”‚   â””â”€â”€ services.py      # ì¶©ì „, í™˜ë¶ˆ ë¡œì§
â”œâ”€â”€ users/               # ì‚¬ìš©ì ì¸ì¦ ë° í”„ë¡œí•„
â”œâ”€â”€ common/              # ì•Œë¦¼, ì§€ì—­/ì¹´í…Œê³ ë¦¬ ë“± ê³µí†µ ê¸°ëŠ¥
â”œâ”€â”€ config/              # Django ì„¤ì • (Settings, ASGI, WSGI)
â”œâ”€â”€ manage.py            # Django ì§„ì…ì 
â”œâ”€â”€ docker-compose.yml   # ê°œë°œìš© ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”œâ”€â”€ docker-compose.prod.yml  # ë°°í¬ìš© ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”œâ”€â”€ nginx.conf           # Nginx ì„¤ì •
â””â”€â”€ requirements.txt     # ì˜ì¡´ì„± íŒ¨í‚¤ì§€
```

---

ì´ í”„ë¡œì íŠ¸ëŠ” **MIT License**ì— ë”°ë¼ ë°°í¬ë©ë‹ˆë‹¤.
